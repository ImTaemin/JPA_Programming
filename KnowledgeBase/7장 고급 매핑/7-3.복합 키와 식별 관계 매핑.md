# π”— λ³µν•©ν‚¤μ™€ μ‹λ³„ κ΄€κ³„ λ§¤ν•‘   

- [1. μ‹λ³„ κ΄€κ³„ vs λΉ„μ‹λ³„ κ΄€κ³„](#1-μ‹λ³„-κ΄€κ³„-vs-λΉ„μ‹λ³„-κ΄€κ³„)
- [2. λ³µν•©ν‚¤ : λΉ„μ‹λ³„ κ΄€κ³„ λ§¤ν•‘](#2-λ³µν•©ν‚¤--λΉ„μ‹λ³„-κ΄€κ³„-λ§¤ν•‘)
    - [@IdClass](#idclass)
    - [@EmbeddedId](#embeddedid)
- [3. λ³µν•©ν‚¤ : μ‹λ³„ κ΄€κ³„ λ§¤ν•‘](#3-λ³µν•©ν‚¤--μ‹λ³„-κ΄€κ³„-λ§¤ν•‘)
    - [@IdClassμ™€ μ‹λ³„ κ΄€κ³„](#idclassμ™€-μ‹λ³„-κ΄€κ³„)
    - [@EmbeddedIdμ™€ μ‹λ³„ κ΄€κ³„](#embeddedidμ™€-μ‹λ³„-κ΄€κ³„)
- [4. λΉ„μ‹λ³„ κ΄€κ³„λ΅ κµ¬ν„](#4-λΉ„μ‹λ³„-κ΄€κ³„λ΅-κµ¬ν„)
- [5. μΌλ€μΌ μ‹λ³„ κ΄€κ³„](#5-μΌλ€μΌ-μ‹λ³„-κ΄€κ³„)
- [6. μ‹λ³„ λΉ„μ‹λ³„ κ΄€κ³„μ μ¥λ‹¨μ ](#6-μ‹λ³„-λΉ„μ‹λ³„-κ΄€κ³„μ-μ¥λ‹¨μ )
- [μ •λ¦¬](#μ •λ¦¬)

## 1. μ‹λ³„ κ΄€κ³„ vs λΉ„μ‹λ³„ κ΄€κ³„   
λ°μ΄ν„°λ² μ΄μ¤ ν…μ΄λΈ” μ‚¬μ΄μ— κ΄€κ³„λ” <u>μ™Έλν‚¤κ°€ κΈ°λ³Έν‚¤μ— ν¬ν•¨λλ”μ§€ μ—¬λ¶€μ— λ”°λΌ μ‹λ³„ κ΄€κ³„μ™€ λΉ„μ‹λ³„ κ΄€κ³„λ΅ κµ¬λ¶„</u>ν•λ‹¤.   

- μ‹λ³„ κ΄€κ³„(Identifying Relationship)   
λ¶€λ¨ ν…μ΄λΈ”μ κΈ°λ³Έν‚¤λ¥Ό λ‚΄λ ¤λ°›μ•„ **μμ‹ ν…μ΄λΈ”μ κΈ°λ³Έν‚¤ + μ™Έλν‚¤λ΅ μ‚¬μ©**ν•λ” κ΄€κ³„λ‹¤.   

    <p align="center"><img src="https://images.velog.io/images/tjdud3550/post/642756bf-e2b2-4c02-a1fd-b0f40e6c2958/image.png" width="60%"></p>   
    
    `PARENT` ν…μ΄λΈ”μ κΈ°λ³Έν‚¤(`PARENT_ID`)λ¥Ό λ°›μ•„μ„ `CHILD` ν…μ΄λΈ”μ κΈ°λ³Έν‚¤ + μ™Έλν‚¤λ΅ μ‚¬μ©ν•λ‹¤.   



- λΉ„μ‹λ³„ κ΄€κ³„(Non-Identifying Relationship)   
λ¶€λ¨ ν…μ΄λΈ”μ κΈ°λ³Έν‚¤λ¥Ό λ°›μ•„μ„ **μμ‹ ν…μ΄λΈ”μ μ™Έλν‚¤λ΅λ§ μ‚¬μ©**ν•λ” κ΄€κ³„λ‹¤.   

    <p align="center"><img src="https://leejaedoo.github.io/assets/img/non_identifying_relationship.jpg" width="60%"></p>   
    
    `PARENT` ν…μ΄λΈ”μ κΈ°λ³Έν‚¤(`PARENT_ID`)λ¥Ό λ°›μ•„μ„ `CHILD` ν…μ΄λΈ”μ μ™Έλν‚¤λ΅λ§ μ‚¬μ©ν•λ‹¤.   
    λΉ„μ‹λ³„ κ΄€κ³„λ” μ™Έλν‚¤μ— `NULL`μ„ ν—μ©ν•λ”μ§€μ— λ”°λΌ ν•„μμ  λΉ„μ‹λ³„ κ΄€κ³„μ™€ μ„ νƒμ  λΉ„μ‹λ³„ κ΄€κ³„λ΅ λ‚λ‰λ‹¤.

    - ν•„μμ  λΉ„μ‹λ³„ κ΄€κ³„(Mandatory) : μ™Έλν‚¤μ— `NULL`μ„ ν—μ©ν•μ§€ μ•λ”λ‹¤. μ—°κ΄€κ΄€κ³„λ¥Ό ν•„μμ μΌλ΅ λ§Ίμ–΄μ•Ό ν•λ‹¤.
    - μ„ νƒμ  λΉ„μ‹λ³„ κ΄€κ³„(Optional) : μ™Έλν‚¤μ— `NULL`μ„ ν—μ©ν•λ‹¤. μ—°κ΄€κ΄€κ³„λ¥Ό λ§Ίμ„μ§€ λ§μ§€ μ„ νƒν•  μ μλ‹¤.   
    <br>

    λ°μ΄ν„°λ² μ΄μ¤ ν…μ΄λΈ”μ„ μ„¤κ³„ν•  λ• μ‹λ³„ κ΄€κ³„λ‚ λΉ„μ‹λ³„ κ΄€κ³„ μ¤‘ ν•λ‚λ¥Ό μ„ νƒν•΄μ•Ό ν•λ‹¤.   
    μµκ·Όμ—λ” λΉ„μ‹λ³„ κ΄€κ³„λ¥Ό μ£Όλ΅ μ‚¬μ©, κΌ­ ν•„μ”ν• κ³³μ—λ§ μ‹λ³„ κ΄€κ³„λ¥Ό μ‚¬μ©ν•λ” μ¶”μ„Έ   
    *JPAλ” μ‹λ³„ κ΄€κ³„μ™€ λΉ„μ‹λ³„ κ΄€κ³„λ¥Ό λ¨λ‘ μ§€μ›*

## 2. λ³µν•©ν‚¤ : λΉ„μ‹λ³„ κ΄€κ³„ λ§¤ν•‘   
κΈ°λ³Έν‚¤λ¥Ό κµ¬μ„±ν•λ” μ»¬λΌμ΄ ν•λ‚λ©΄ λ‹¨μν•κ² λ§¤ν•‘ν•λ‹¤.   
```java
@Entity
public class Hello{
    @Id
    private String id;
}
```
JPAμ—μ„ μ‹λ³„μλ¥Ό λ‘ μ΄μƒ μ‚¬μ©ν•λ ¤λ©΄ **λ³„λ„μ μ‹λ³„μ ν΄λμ¤λ¥Ό λ§λ“¤μ–΄μ•Ό ν•λ‹¤.**   
```java
//μ¤λ¥(λ³„λ„μ μ‹λ³„μ ν΄λμ¤λ¥Ό λ§λ“¤μ§€ μ•μ)
@Entity
public class Hello{
    @Id
    private String id1;
    @Id
    private String id2; //μ‹¤ν–‰ μ‹μ μ— λ§¤ν•‘ μμ™Έ
}
```
JPAλ” μμ†μ„± μ»¨ν…μ¤νΈμ— μ—”ν‹°ν‹°λ¥Ό λ³΄κ΄€ν•  λ• **μ—”ν‹°ν‹°μ μ‹λ³„μλ¥Ό ν‚¤λ΅ μ‚¬μ©**ν•λ‹¤.   
κ·Έλ¦¬κ³  μ‹λ³„μλ¥Ό κµ¬λ¶„ν•κΈ° μ„ν•΄ `equals`μ™€ `hashCode`λ¥Ό μ‚¬μ©ν•΄μ„ λ™λ“±μ„± λΉ„κµλ¥Ό ν•λ‹¤.   
κ·Έλ°λ° μ‹λ³„μ ν•„λ“κ°€ ν•λ‚μΌ λ•λ” λ³΄ν†µ μλ°”μ κΈ°λ³Έ νƒ€μ…μ„ μ‚¬μ©ν•λ―€λ΅ λ¬Έμ κ°€ μ—†μ§€λ§,   
μ‹λ³„μ ν•„λ“κ°€ 2κ° μ΄μƒμ΄λ©΄ λ³„λ„μ μ‹λ³„μ ν΄λμ¤λ¥Ό λ§λ“¤κ³  κ·Έκ³³μ— `equals`μ™€ `hashCode`λ¥Ό κµ¬ν„ν•΄μ•Ό ν•λ‹¤.   

JPAλ” λ³µν•©ν‚¤λ¥Ό μ§€μ›ν•κΈ° μ„ν•΄ `@IdClass`μ™€ `@EmbeddedId` 2κ°€μ§€ λ°©λ²•μ„ μ κ³µ   
`@IdClass`λ” κ΄€κ³„ν• λ°μ΄ν„°λ² μ΄μ¤μ— κ°€κΉμ΄ λ°©λ²•μ΄κ³ ,   
`@EmbeddedId`λ” μΆ€ λ” κ°μ²΄μ§€ν–¥μ— κ°€κΉμ΄ λ°©λ²•μ΄λ‹¤.   

### @IdClass
λ³µν•©ν‚¤ ν…μ΄λΈ”μ€ λΉ„μ‹λ³„ κ΄€κ³„κ³  `PARENT`λ” λ³µν•© κΈ°λ³Έν‚¤λ¥Ό μ‚¬μ©ν•λ‹¤.   
(μ—¬κΈ°μ„ λ§ν•λ” λ¶€λ¨(`PARENT`) μμ‹(`CHILD`)μ€ κ°μ²΄μ μƒμ†κ³Ό λ¬΄κ΄€)   

<p align="center"><img src="https://s1.md5.ltd/image/8a50434d85247effc0c343cc14dfd167.png" width="60%"></p>   

`PARENT` ν…μ΄λΈ”μ κΈ°λ³Έν‚¤λ¥Ό `PAENT_ID1`, `PARENT_ID2`λ΅ λ¬¶μ€ λ³µν•©ν‚¤λ΅ κµ¬μ„±ν–λ‹¤.   
*λ³µν•©ν‚¤λ¥Ό λ§¤ν•‘ν•κΈ° μ„ν• μ‹λ³„μ ν΄λμ¤λ¥Ό λ§λ“¤μ–΄μ•Ό ν•λ‹¤.*   
```java
@Entity
@IdClass(ParentId.class)
public class Parent{
    @Id
    @Column(name = "PARENT_ID1")
    private String id1; //ParentId.id1κ³Ό μ—°κ²°
    
    @Id
    @Column(name = "PARENT_ID2")
    private String id2; //ParentId.id2μ™€ μ—°κ²°
    
    private String name;
    ...
}
public class ParentId implements Serializable {
	
    private String id1; //Parent.id1 λ§¤ν•‘
    private String id2; //Parent.id2 λ§¤ν•‘
    
    public ParentId(){}

    public ParentId(String id1, String id2){
        this.id1 = id1;
        this.id2 = id2;
    }

    @Override
    public int hashcode() {...}
    
    @Override
    public boolean equals(Object obj) {...}
}
```
κ°κ°μ κΈ°λ³Έν‚¤ μ»¬λΌμ„ `@Id`λ΅ λ§¤ν•‘ν–κ³ ,   
`@IdClass`λ¥Ό μ‚¬μ©ν•΄μ„ `ParentId`ν΄λμ¤λ¥Ό μ‹λ³„μ ν΄λμ¤λ΅ μ§€μ •ν–λ‹¤.   

`@IdClass`λ¥Ό μ‚¬μ©ν•  λ• μ‹λ³„μ ν΄λμ¤κ°€ λ§μ΅±ν•΄μ•Ό ν•λ” μ΅°κ±΄  
- **μ‹λ³„μ ν΄λμ¤μ μ†μ„±λ…κ³Ό μ—”ν‹°ν‹°μ—μ„ μ‚¬μ©ν•λ” μ‹λ³„μμ μ†μ„±λ…μ΄ κ°™μ•„μ•Ό ν•λ‹¤.**   
`Parent.id1`==`ParentId.id1`, `Parent.id2`==`ParentId.id2`
- `Serializable` μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•΄μ•Ό ν•λ‹¤.
- equals, hasCodeλ¥Ό κµ¬ν„ν•΄μ•Ό ν•λ‹¤.
- κΈ°λ³Έ μƒμ„±μκ°€ μμ–΄μ•Ό ν•λ‹¤.
- μ‹λ³„μ ν΄λμ¤λ” `public` μ΄μ–΄μ•Ό ν•λ‹¤.

μ‹¤μ  μ‚¬μ©   
```java
//λ³µν•©ν‚¤λ¥Ό μ‚¬μ©ν•λ” μ—”ν‹°ν‹°λ¥Ό μ €μ¥
Parent parent = new Parent();
parent.setId1("myId1"); //μ‹λ³„μ
parent.setId2("myId2"); //μ‹λ³„μ
parent.setName("parentName");
em.persist(parent);
```
μ‹λ³„μ ν΄λμ¤μΈ `ParentId`κ°€ λ³΄μ΄μ§€ μ•λ”λ°, `em.persist()`λ¥Ό νΈμ¶ν•λ©΄ μμ†μ„± μ»¨ν…μ¤νΈμ— μ—”ν‹°ν‹°λ¥Ό λ“±λ΅ν•κΈ° μ§μ „μ— λ‚΄λ¶€μ—μ„ `Parent.id1`, `Parent.id2` κ°’μ„ μ‚¬μ©ν•΄μ„ μ‹λ³„μ ν΄λμ¤μΈ `ParentId`λ¥Ό μƒμ„±ν•κ³  μμ†μ„± μ»¨ν…μ¤νΈμ ν‚¤λ΅ μ‚¬μ©ν•λ‹¤.

```java
//λ³µν•©ν‚¤λ΅ μ΅°ν
ParentId parentId = new ParentId("myId1", "myId2");
Parent parent = em.find(Parent.class, parentId);
```
μ‹λ³„μ ν΄λμ¤μΈ `ParentId`λ¥Ό μ‚¬μ©ν•΄ μ—”ν‹°ν‹°λ¥Ό μ΅°νν•λ‹¤.   

```java
//μμ‹ ν΄λμ¤ μ¶”κ°€
@Entity
public class Child{
    @Id
    private String id;

    @ManyToOne
    @JoinColumns({
    	@JoinColumn(name = "PARENT_ID1", referenceColumnName = "PARENT_ID1"),
        @JoinColumn(name = "PARENT_ID2", referenceColumnName = "PARENT_ID2")
    })
    private Parent parent;
}
```
λ¶€λ¨ ν…μ΄λΈ”μ κΈ°λ³Έν‚¤ μ»¬λΌμ΄ λ³µν•©ν‚¤μ΄λ―€λ΅ μμ‹ ν…μ΄λΈ”μ μ™Έλν‚¤λ„ λ³µν•©ν‚¤λ‹¤.   
λ”°λΌμ„ μ™Έλν‚¤ λ§¤ν•‘ μ‹ μ—¬λ¬ μ»¬λΌμ„ λ§¤ν•‘ν•΄μ•Ό ν•λ―€λ΅ `@JoinColumns` μ–΄λ…Έν…μ΄μ…μ„ μ‚¬μ©ν•κ³  κ°κ°μ μ™Έλν‚¤ μ»¬λΌμ„ `@JoinColumns`μΌλ΅ λ§¤ν•‘ν•λ‹¤.   
`@JoinColumn`μ `name`κ³Ό `referenceColumnName`μ κ°’μ΄ κ°™μΌλ©΄ `referenceColumnName`μ€ μƒλµν•΄λ„ λλ‹¤.

### EmbeddedId   
`@IdClass`κ°€ λ°μ΄ν„°λ² μ΄μ¤μ— λ§μ¶ λ°©λ²•μ΄λΌλ©΄   
`@EmbeddedId`λ” μΆ€ λ” κ°μ²΄μ§€ν–¥μ μΈ λ°©λ²•μ΄λ‹¤.   
```java
@Entity
public class Parent{
    @EmbeddedId
    private ParentId id;
    
    private String name;
    ...
}

@Embeddable
public class ParentId implements Serializable{
    @Column(name = "PARENT_ID1")
    private String id1;
    @Column(name = "PARENT_ID2")
    private String id2;

    //equals, hashCode κµ¬ν„
}
```
`@IdClass`μ™€λ” λ‹¤λ¥΄κ² `@EmbeddedId`λ¥Ό μ μ©ν• μ‹λ³„μ ν΄λμ¤λ” **μ‹λ³„μ ν΄λμ¤μ— κΈ°λ³Έν‚¤λ¥Ό μ§μ ‘ λ§¤ν•‘**ν•λ‹¤.   

`@EmbeddedId`λ¥Ό μ μ©ν• μ‹λ³„μ ν΄λμ¤κ°€ λ§μ΅±ν•΄μ•Ό ν•λ” μ΅°κ±΄   
- `@Embeddable` μ–΄λ…Έν…μ΄μ…μ„ λ¶™μ—¬μ£Όμ–΄μ•Ό ν•λ‹¤.
- `Serializable` μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•΄μ•Ό ν•λ‹¤.
- `equals`, `hashCode`λ¥Ό κµ¬ν„ν•΄μ•Ό ν•λ‹¤.
- κΈ°λ³Έ μƒμ„±μκ°€ μμ–΄μ•Ό ν•λ‹¤.
- μ‹λ³„μ ν΄λμ¤λ” `public`μ΄μ–΄μ•Ό ν•λ‹¤.

```java
//μ—”ν‹°ν‹° μ €μ¥
Parent parent = new Parent();
ParentId parentId = new ParentId("myId1","myId2");
parent.setId(parentId);
parent.setName("parentName");
em.persist(parent);
```
μ‹λ³„μ ν΄λμ¤ `parentId`λ¥Ό μ§μ ‘ μƒμ„±ν•΄μ„ μ‚¬μ©ν•λ‹¤.

```java
//μ—”ν‹°ν‹° μ΅°ν
ParentId parentId = new ParentId("myId1","myId2");
Parent parent = em.find(Parent.class, parentId);
```
μ΅°ν μ½”λ“λ„ μ‹λ³„μ ν΄λμ¤ `parentId`λ¥Ό μ§μ ‘ μ‚¬μ©ν•λ‹¤.

### λ³µν•©ν‚¤μ™€ equals(), hashCode()
**λ³µν•©ν‚¤λ” `equals()`μ™€ `hashCode()`λ¥Ό ν•„μλ΅ κµ¬ν„ν•΄μ•Ό ν•λ‹¤.**   
```java
Parent id1 = new Parent();
id1.setId1("myId1"); 
id1.setId2("myId2");

Parent id2 = new Parent();
id2.setId1("myId1"); 
id2.setId2("myId2");

//id1.equals(id2) -> ??
```
`equals()`λ¥Ό μ μ ν κµ¬ν„ν–λ‹¤λ©΄ μ°Έμ΄κ³  μ•„λ‹λ©΄ κ±°μ§“μ΄λ‹¤.   
JPAλ” μ—”ν‹°ν‹°λ¥Ό μμ†μ‹ν‚¬ λ• κΈ°λ³Έ PKκ°’μ„ μ΄μ©ν•μ—¬ κµ¬λ¶„ν•λ‹¤.   
`equals()` λ” `Object`μ κΈ°λ³Έκµ¬ν„μ—μ„ **μΈμ¤ν„΄μ¤μ μ£Όμ†λ¥Ό λΉ„κµ(λ™μΌμ„± λΉ„κµ)ν•λ‹¤.**   
λ§μ•½ PK κ°’μ΄ λ‘κ°™μ€ μ‹λ³„μ ν΄λμ¤μΈ μΈμ¤ν„΄μ¤κ°€ 2κ° μλ‹¤κ³  κ°€μ •ν•λ‹¤λ©΄ JPA μ—μ„λ” μ΄ λ‘μ„ κ°™λ‹¤κ³  νλ‹¨ν•΄μ•Ό ν•΄λ‹Ή μ‹λ³„μ ν΄λμ¤λ΅ κ²€μƒ‰ν• μ—”ν‹°ν‹°κ°€ κ°™μ€ μ—”ν‹°ν‹°μ„μ„ λ³΄μ¥ν•  μ μλ‹¤.   
κ·Έλμ„ `equals()`λ¥Ό **λ™μΌμ„± λΉ„κµκ°€ μ•„λ‹λΌ λ™λ“±μ„± λΉ„κµ**λ΅ μ¬μ •μν•΄μ•Ό ν•κ³ ,   
κ°™μ€ λ§¥λ½μΈ `hashCode()`λ„ μ¬μ •μν•΄μ•Ό ν•λ‹¤.   
*μ‹λ³„μ ν΄λμ¤λ” λ³΄ν†µ `equals()`μ™€ `hashCode()`λ¥Ό κµ¬ν„ν•  λ• λ¨λ“  ν•„λ“λ¥Ό μ‚¬μ©ν•λ‹¤.*

### @IdClass vs @EmbeddedId   
`@IdClass`μ™€ `@EmbeddedId`λ” κ°κ° μ¥λ‹¨μ μ΄ μμΌλ―€λ΅ λ³ΈμΈμ μ·¨ν–¥μ— λ§λ” κ²ƒμ„ μΌκ΄€μ„± μκ² μ‚¬μ©ν•λ©΄ λλ‹¤.   
`@EmbeddedId`κ°€ λ” κ°μ²΄μ§€ν–¥μ μ΄κ³  μ¤‘λ³µλ„ μ—†μ–΄μ„ μΆ‹μ•„λ³΄μ΄κΈ΄ ν•μ§€λ§ νΉμ • μƒν™©μ— JPQLμ΄ μ΅°κΈ λ” κΈΈμ–΄μ§ μ μλ‹¤.   
```java
//@EmbeddedId
em.createQuery("SELECT p.id.id1, p.id.id2 FROM Parent p");
//@IdClass
em.createQuery("SELECT p.id1, p.id2 FROM Parent p");
```
<details>
<summary>μ°Έκ³ </summary>

λ³µν•©ν‚¤μ—λ” `@GeneratedValue`λ¥Ό μ‚¬μ©ν•  μ μ—†λ‹¤.   
λ³µν•©ν‚¤λ¥Ό κµ¬μ„±ν•λ” μ—¬λ¬ μ»¬λΌ μ¤‘ ν•λ‚μ—λ„ μ‚¬μ©ν•  μ μ—†λ‹¤.
</details>

## 3. λ³µν•©ν‚¤ : μ‹λ³„ κ΄€κ³„ λ§¤ν•‘   
<p align="center"><img src="https://3553248446-files.gitbook.io/~/files/v0/b/gitbook-legacy-files/o/assets%2F-M5HOStxvx-Jr0fqZhyW%2F-M6xBNg_qefrpc7aASBC%2F-M6xPlGnDKcr_nL8eG5u%2F7-9.png?alt=media&token=097a6b21-3f3b-44eb-af12-552c17a67f7b" width="60%"></p>   

λ¶€λ¨, μμ‹, μ†μκΉμ§€ κ³„μ† κΈ°λ³Έν‚¤λ¥Ό μ „λ‹¬ν•λ” μ‹λ³„ κ΄€κ³„λ‹¤.   
μ‹λ³„ κ΄€κ³„μ—μ„ μμ‹ ν…μ΄λΈ”μ€ λ¶€λ¨ ν…μ΄λΈ”μ κΈ°λ³Έν‚¤λ¥Ό ν¬ν•¨ν•΄μ„ λ³µν•©ν‚¤λ¥Ό κµ¬μ„±ν•΄μ•Ό ν•λ―€λ΅ `@IdClass`λ‚ `@EmbeddedId`λ¥Ό μ‚¬μ©ν•΄μ„ μ‹λ³„μλ¥Ό λ§¤ν•‘ν•΄μ•Ό ν•λ‹¤.

### IdClassμ™€ μ‹λ³„ κ΄€κ³„
```java
/*****@IdClass μ‚¬μ©*****/
//λ¶€λ¨
@Entity
public class Parent {
    @Id @Column(name = "PARENT_ID")
    private String id;
    private String name;
    ...
}

//μμ‹
@Entity
@IdClass(ChildId.class)
public class Child {
    @Id
    @ManyToOne
    @JoinColumn(name = "PARENT_ID")
    public Parent parent;

    @Id @Column(name = "CHILD_ID")
    private String childId;

    private String name;
}

//μμ‹ ID
public class ChildId implements Serializable {
    private String parent;  //Child.parent λ§¤ν•‘
    private String childId; //Child.childId λ§¤ν•‘
    //equals, hashCode
}

//μ†μ
@Entity
@IdClass(GrandChildld.class)
public class GrandChild {
    @Id
    @ManyToOne
    @JoinColumns({
        @JoinColumn(name = "PARENT_ID"),
        @JoinColumn(name = "CHILD_ID")
    })
    private Child child;

    @Id @Column(name = "GRANDCHILD_ID")
    private String id;
    private String name;
    ...
}

//μ†μ ID
public class GrandChildld implements Serializable {
    private ChildId child; //GrandChild.child λ§¤ν•‘
    private String id;     //GrandChild.id λ§¤ν•‘

    //equals, hashCode
    ...
}
```
μ‹λ³„ κ΄€κ³„λ” κΈ°λ³Έν‚¤μ™€ μ™Έλν‚¤λ¥Ό κ°™μ΄ λ§¤ν•‘ν•΄μ•Ό ν•λ‹¤.   
λ”°λΌμ„ μ‹λ³„μ λ§¤ν•‘μΈ `@Id`μ™€ μ—°κ΄€κ΄€κ³„ λ§¤ν•‘μΈ `@ManyToOne`μ„ κ°™μ΄ μ‚¬μ©ν•λ©΄ λλ‹¤.
```java
@Id
@ManyToOne
@JoinColumn(name = "PARENT_ID")
public Parent parent;
```
`Child.parent`λ¥Ό λ³΄λ©΄ `@Id`λ΅ κΈ°λ³Έν‚¤λ¥Ό λ§¤ν•‘ν•λ©΄μ„ `@ManyToOne`κ³Ό `@JoinColumn`μΌλ΅ μ™Έλν‚¤λ¥Ό κ°™μ΄ λ§¤ν•‘ν•λ‹¤.


### @EmbeddedIdμ™€ μ‹λ³„ κ΄€κ³„   
`@EmbeddedId`λ΅ μ‹λ³„ κ΄€κ³„λ¥Ό κµ¬μ„±ν•  λ•λ” `@MapsId`λ¥Ό μ‚¬μ©ν•΄μ•Ό ν•λ‹¤.   
```java
/*****@EmbeddedId μ‚¬μ©*****/
//λ¶€λ¨
@Entity
public class Parent {
  @Id @Column(name = "PARENT_ID")
  private String id;

  private String name;
}

//μμ‹
@Entity
public class Child {
  @EmbeddedId
  private ChildId id;

  @MapsId("parentId") //ChildId.parentId λ§¤ν•‘
  @ManyToOne
  @JoinColumn(name = "PARENT_ID")
  public Parent parent;

  private String name;
}

//μμ‹ ID
@Embeddable
public class ChildId implements Serializable {
  private String parentId; //@MapsId("parentId")λ΅ λ§¤ν•‘
  
  @Column(name = "CHILD_ID")
  private String id;

  //equals, hashCode
  ...
}

//μ†μ
@Entity
public class GrandChild {
  @EmbeddedId
  private GrandChildId id;

  @MapsId("childId") //GrandChildId.childId λ§¤ν•‘
  @ManyToOne
  @JoinColumns({
    @JoinColumn(name = "PARENT_ID"),
    @JoinColumn(name = "CHILD_ID")
  })
  private Child child;

  private String name;
	...
}

//μ†μ ID
@Embeddable
public class GrandChildld implements Serializable {
  private Childld childld; //@MapsId("childld")λ΅ λ§¤ν•‘
  
  @Column(name = "GRANDCHILD_ID")
  private String id;

  //equals, hashCode
  ... 
}
```
`@EmbeddedId`λ” μ‹λ³„ κ΄€κ³„λ΅ μ‚¬μ©ν•  μ—°κ΄€κ΄€κ³„μ μ†μ„±μ— `@MapsId`λ¥Ό μ‚¬μ©ν•λ©΄ λλ‹¤.   
```java
//Child
@MapsId("parentId")
@ManyToOne
@JoinColumn(name = "PARENT_ID")
public Parent parent;
```
`@IdClass`μ™€ λ‹¤λ¥Έ μ μ€ `@Id` λ€μ‹ μ— `@MapsId`λ¥Ό μ‚¬μ©ν–λ‹¤.   
**`@MapsId`λ” μ™Έλν‚¤μ™€ λ§¤ν•‘ν• μ—°κ΄€κ΄€κ³„λ¥Ό κΈ°λ³Έν‚¤μ—λ„ λ§¤ν•‘ν•κ² λ‹¤λ” λ»μ΄λ‹¤.**   
μ†μ„± κ°’μ€ `@EmbeddedId`λ¥Ό μ‚¬μ©ν• μ‹λ³„μ ν΄λμ¤μ κΈ°λ³Έν‚¤ ν•„λ“λ¥Ό μ§€μ •ν•λ©΄ λλ‹¤.(`ChildId.parentId`)

## 4. λΉ„μ‹λ³„ κ΄€κ³„λ΅ κµ¬ν„   
<p align="center"><img src="https://blog.kakaocdn.net/dn/tgpzQ/btrn1qA31xG/3PBukkc8xf36n3kkIBM6mK/img.png" width="60%"></p>   

```java
//λ¶€λ¨
@Entity
public class Parent {
  @Id @GeneratedValue
  @Column(name = "PARENT_ID")
  private Long id;
  private String name;
  ...
}

//μμ‹
@Entity
public class Child {
  @Id @GeneratedValue
  @Column(name = "CHILD_ID")
  private Long id;

  private String name;

  @ManyToOne
  @JoinColumn(name = "PARENT_ID")
  private Parent parent;
  ...
}

//μ†μ
@Entity
public class Grandchild {
  @Id @GeneratedValue
  @Column(name = "GRANDCHILD_ID")
  private Long id;

  private String name;

  @ManyToOne
  @JoinColumn(name = "CHILD_ID")
  private Child child;
  ...
}
```
λ³µν•©ν‚¤κ°€ μ—†μΌλ―€λ΅ λ³µν•©ν‚¤ ν΄λμ¤λ¥Ό λ§λ“¤μ§€ μ•μ•„λ„ λλ‹¤.


## 5. μΌλ€μΌ μ‹λ³„ κ΄€κ³„   
<p align="center"><img src="https://leejaedoo.github.io/assets/img/%EC%9D%BC%EB%8C%80%EC%9D%BC%EC%8B%9D%EB%B3%84.JPG" width="60%"></p>   

μΌλ€μΌ μ‹λ³„ κ΄€κ³„λ” μμ‹ ν…μ΄λΈ”μ κΈ°λ³Έν‚¤ κ°’μΌλ΅ λ¶€λ¨ ν…μ΄λΈ”μ κΈ°λ³Έν‚¤ κ°’λ§ μ‚¬μ©ν•λ‹¤.   
κ·Έλμ„ *λ¶€λ¨ ν…μ΄λΈ”μ κΈ°λ³Έν‚¤κ°€ λ³µν•©ν‚¤κ°€ μ•„λ‹λ©΄ μμ‹ ν…μ΄λΈ”μ κΈ°λ³Έν‚¤λ” λ³µν•©ν‚¤λ΅ κµ¬μ„±ν•μ§€ μ•μ•„λ„ λλ‹¤.*

```java
//λ¶€λ¨
@Entity
public class Board {
  @Id @GeneratedValue
  @Column(name = "BOARD_ID")
  private Long id;

  private String titie;

  @OneToOne(mappedBy = "board")
  private BoardDetail boardDetail;
  ...
}

//μμ‹
@Entity
public class BoardDetail {
  @Id
  private Long boardId;

  @MapsId //BoardDetail.boardId λ§¤ν•‘
  @OneToOne
  @JoinColumn(name="BOARD_ID")
  private Board board;

  private String content;
  ...
}
```
`BoardDetail`μ²λΌ μ‹λ³„μκ°€ μ»¬λΌ ν•λ‚λ©΄ `@MapsId`λ¥Ό μ‚¬μ©ν•κ³  μ†μ„± κ°’μ€ λΉ„μ›λ‘λ©΄ λλ‹¤.   
μ΄λ• `@MapsId`λ” `@Id`λ¥Ό μ‚¬μ©ν•΄μ„ μ‹λ³„μλ΅ μ§€μ •ν• `BoardDetail.boardId`μ™€ λ§¤ν•‘λλ‹¤.   
```java
public void save(){
    Board board = new Board();
    board.setTitle("μ λ©");
    em.persist(board);

    BoardDetail boardDetail = new BoardDetail();
    boardDetail.setContent("λ‚΄μ©");
    boardDetail.setBoard(board);
    em.persist(boardDetail);
}
```

## 6. μ‹λ³„, λΉ„μ‹λ³„ κ΄€κ³„μ μ¥λ‹¨μ    
### <u>λ°μ΄ν„°λ² μ΄μ¤ μ„¤κ³„ κ΄€μ </u>μ—μ„ λ³΄λ©΄ μ‹λ³„ κ΄€κ³„λ³΄λ‹¤λ” λΉ„μ‹λ³„ κ΄€κ³„λ¥Ό μ„ νΈν•λ‹¤.   
- μ‹λ³„ κ΄€κ³„λ” λ¶€λ¨ ν…μ΄λΈ”μ κΈ°λ³Έν‚¤λ¥Ό μμ‹ ν…μ΄λΈ”λ΅ μ „νν•λ©΄μ„ **μμ‹ ν…μ΄λΈ”μ κΈ°λ³Έν‚¤ μ»¬λΌμ΄ μ μ  λμ–΄λ‚λ‹¤**.   
*κ²°κµ­ μ΅°μΈν•  λ• SQLμ΄ λ³µμ΅ν•΄μ§€κ³  κΈ°λ³Έν‚¤ μΈλ±μ¤κ°€ λ¶ν•„μ”ν•κ² μ»¤μ§ μ μλ‹¤.*
- λΉ„μ¦λ‹μ¤ μ”κµ¬μ‚¬ν•­μ€ μ‹κ°„μ΄ μ§€λ‚¨μ— λ”°λΌ μ–Έμ  κ°€λ” λ³€ν•λ‹¤.   
μ‹λ³„ κ΄€κ³„μ μμ—° ν‚¤ μ»¬λΌλ“¤μ΄ μμ‹μ— μ†μκΉμ§€ μ „νλλ©΄ λ³€κ²½ν•κΈ° νλ“¤λ‹¤.
- μ‹λ³„ κ΄€κ³„λ” 2κ° μ΄μƒμ μ»¬λΌμ„ ν•©ν•΄μ„ λ³µν•© κΈ°λ³Έν‚¤λ¥Ό λ§λ“¤μ–΄μ•Ό ν•λ” κ²½μ°κ°€ λ§λ‹¤.
- μ‹λ³„ κ΄€κ³„λ” λ¶€λ¨ ν…μ΄λΈ”μ κΈ°λ³Έν‚¤λ¥Ό μμ‹ ν…μ΄λΈ”μ κΈ°λ³Έν‚¤λ΅ μ‚¬μ©ν•λ―€λ΅ **ν…μ΄λΈ” κµ¬μ΅°κ°€ μ μ—°ν•μ§€ λ»ν•λ‹¤.**

### <u>κ°μ²΄ λ§¤ν•‘ κ΄€μ </u>μ—μ„ λ³΄λ©΄ μ•„λ μ΄μ λ“¤λ΅ λΉ„μ‹λ³„ κ΄€κ³„λ¥Ό μ„ νΈν•λ‹¤.
- μΌλ€μΌ κ΄€κ³„λ¥Ό μ μ™Έν•κ³  μ‹λ³„ κ΄€κ³„λ” 2κ° μ΄μƒμ μ»¬λΌμ„ λ¬¶μ€ λ³µν•© κΈ°λ³Έν‚¤λ¥Ό μ‚¬μ©ν•λ‹¤.   
**JPAμ—μ„ λ³µν•©ν‚¤λ” λ³„λ„μ λ³µν•©ν‚¤ ν΄λμ¤λ¥Ό λ§λ“¤μ–΄μ„ μ‚¬μ©ν•΄μ•Ό ν•λ‹¤.**   
λ”°λΌμ„ μ»¬λΌμ΄ ν•λ‚μΈ κΈ°λ³Έν‚¤ λ¥Ό λ§¤ν•‘ν•λ” κ²ƒλ³΄λ‹¤ λ§μ€ λ…Έλ ¥μ΄ ν•„μ”ν•λ‹¤.
- λΉ„μ‹λ³„ κ΄€κ³„μ κΈ°λ³Έν‚¤λ” μ£Όλ΅ λ€λ¦¬ν‚¤λ¥Ό μ‚¬μ©ν•λ‹¤.   
JPAλ” `@GeneratedValue`μ²λΌ **λ€λ¦¬ν‚¤λ¥Ό μƒμ„±ν•κΈ° μ„ν• νΈλ¦¬ν• λ°©λ²•μ„ μ κ³µ**ν•λ‹¤.

### μ‹λ³„ κ΄€κ³„κ°€ κ°€μ§€λ” μ¥μ λ„ μλ‹¤.
- κΈ°λ³Έν‚¤ μΈλ±μ¤λ¥Ό ν™μ©ν•κΈ° μΆ‹λ‹¤.
- μƒμ„ ν…μ΄λΈ”λ“¤μ κΈ°λ³Έν‚¤ μ»¬λΌμ„ μμ‹, μ†μ ν…μ΄λΈ”λ“¤μ΄ κ°€μ§€κ³  μμΌλ―€λ΅   
νΉμ • μƒν™©μ— **μ΅°μΈ μ—†μ΄ ν•μ„ ν…μ΄λΈ”λ§μΌλ΅ κ²€μƒ‰**μ„ μ™„λ£ν•  μ μλ‹¤.   <br><br>
    κΈ°λ³Έν‚¤ μΈλ±μ¤λ¥Ό ν™μ©ν•λ” μ
    ```sql
    --λ¶€λ¨ μ•„μ΄λ””κ°€ AμΈ λ¨λ“  μμ‹ μ΅°ν
    SELECT * FROM CHILD
    WHERE PARENT_ID = 'A'

    --λ¶€λ¨ μ•„μ΄λ””κ°€ Aκ³  μμ‹ μ•„μ΄λ””κ°€ BμΈ μμ‹ μ΅°ν
    SELECT * FROM CHILD
    WHERE PARENT_ID = 'A' AND CHILD_ID = 'B'
    ```   

    λ‘ κ²½μ° λ¨λ‘ `CHILD` ν…μ΄λΈ”μ κΈ°λ³Έν‚¤ μΈλ±μ¤λ¥Ό `PARENT_ID` + `CHILD_ID`λ΅ κµ¬μ„±ν•λ©΄ λ³„λ„μ μΈλ±μ¤λ¥Ό μƒμ„±ν•  ν•„μ” μ—†μ΄ κΈ°λ³Έν‚¤ μΈλ±μ¤λ§ μ‚¬μ©ν•΄λ„ λλ‹¤.

## μ •λ¦¬   
- ORM μ‹ κ· ν”„λ΅μ νΈ μ§„ν–‰μ‹ μ¶”μ²ν•λ” λ°©λ²•μ€ λ  μ μμΌλ©΄   
***λΉ„μ‹λ³„ κ΄€κ³„λ¥Ό μ‚¬μ©ν•κ³  κΈ°λ³Έν‚¤λ” Long νƒ€μ…μ λ€λ¦¬ν‚¤λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ΄λ‹¤.***   
- λ€λ¦¬ν‚¤λ” λΉ„μ¦λ‹μ¤μ™€ μ•„λ¬΄ κ΄€λ ¨μ΄ μ—†μ–΄ λΉ„μ¦λ‹μ¤κ°€ λ³€κ²½λμ–΄λ„ μ μ—°ν• λ€μ²κ°€ κ°€λ¥ν•λ‹¤λ” μ¥μ μ΄ μλ‹¤.   
- JPAλ” `@GeneratedValue`λ¥Ό ν†µν•΄ κ°„νΈν•κ² λ€λ¦¬ν‚¤λ¥Ό μƒμ„±ν•  μ μκ³  μ‹λ³„μ μ»¬λ¦Όμ΄ ν•λ‚μ—¬μ„ μ‰½κ² λ§¤ν•‘μ΄ κ°€λ¥ν•λ‹¤.   
- μ‹λ³„μμ λ°μ΄ν„° νƒ€μ…μ€ Longμ„ μ¶”μ²ν•λ‹¤. (Integer = 20μ–µ, Long=920κ²½)   
- μ„ νƒμ  λΉ„μ‹λ³„ κ΄€κ³„λ³΄λ‹¤λ” **ν•„μμ  λΉ„μ‹λ³„ κ΄€κ³„λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ΄ μΆ‹λ‹¤.**   
μ„ νƒμ μΈ λΉ„μ‹λ³„ κ΄€κ³„λ” `NULL`μ„ ν—μ©ν•λ―€λ΅ μ΅°μΈν•  λ• μ™Έλ¶€μ΅°μΈμ„ μ‚¬μ©ν•΄μ•Ό ν•λ‹¤.   
λ°λ©΄, **ν•„μμ  κ΄€κ³„λ” `NOT NULL`λ΅ ν•­μƒ κ΄€κ³„κ°€ μλ‹¤λ” κ²ƒμ„ λ³΄μ¥**ν•λ―€λ΅ λ‚΄λ¶€ μ΅°μΈλ§ μ‚¬μ©ν•΄λ„ λλ‹¤.