# π‘¨β€π‘©β€π‘¦β€π‘¦ λ‹¤λ€λ‹¤ [N:N]   

- [1. λ‹¤λ€λ‹¤ : λ‹¨λ°©ν–¥](#1-λ‹¤λ€λ‹¤--λ‹¨λ°©ν–¥)
- [2. λ‹¤λ€λ‹¤ : μ–‘λ°©ν–¥](#2-λ‹¤λ€λ‹¤--μ–‘λ°©ν–¥)
- [3. λ‹¤λ€λ‹¤ : λ§¤ν•‘μ ν•κ³„μ™€ κ·Ήλ³µ, μ—°κ²° μ—”ν‹°ν‹° μ‚¬μ©](#3-λ‹¤λ€λ‹¤--λ§¤ν•‘μ-ν•κ³„μ™€-κ·Ήλ³µ-μ—°κ²°-μ—”ν‹°ν‹°-μ‚¬μ©)
- [4. λ‹¤λ€λ‹¤ : μƒλ΅μ΄ κΈ°λ³Έν‚¤ μ‚¬μ©](#4-λ‹¤λ€λ‹¤--μƒλ΅μ΄-κΈ°λ³Έν‚¤-μ‚¬μ©)
- [5. λ‹¤λ€λ‹¤ μ—°κ΄€κ΄€κ³„ μ •λ¦¬](#5-λ‹¤λ€λ‹¤-μ—°κ΄€κ΄€κ³„-μ •λ¦¬)

<u>κ΄€κ³„ν• λ°μ΄ν„°λ² μ΄μ¤λ” μ •κ·ν™”λ ν…μ΄λΈ” 2κ°λ΅ λ‹¤λ€λ‹¤ κ΄€κ³„λ¥Ό ν‘ν„ν•  μ μ—†λ‹¤.</u>   
κ·Έλμ„ λ³΄ν†µ λ‹¤λ€λ‹¤ κ΄€κ³„λ¥Ό μΌλ€λ‹¤, λ‹¤λ€μΌ κ΄€κ³„λ΅ ν’€μ–΄λ‚΄λ” μ—°κ²° ν…μ΄λΈ”μ„ μ‚¬μ©ν•λ‹¤.   

- νμ›λ“¤μ€ μƒν’μ„ μ£Όλ¬Έν•λ‹¤.   
- λ°λ€λ΅ μƒν’λ“¤μ€ νμ›λ“¤μ— μν•΄ μ£Όλ¬Έλλ‹¤.   

λ‘μ€ λ‹¤λ€λ‹¤ κ΄€κ³„λ‹¤. λ”°λΌμ„ νμ› ν…μ΄λΈ”κ³Ό μƒν’ ν…μ΄λΈ”λ§μΌλ΅λ” κ΄€κ³„λ¥Ό ν‘ν„ν•  μ μ—†λ‹¤.   

κ·Έλμ„ **μ¤‘κ°„μ— μ—°κ²° ν…μ΄λΈ”μ„ μ¶”κ°€**ν•΄μ•Ό ν•λ‹¤.   
μ΄ ν…μ΄λΈ”μ„ μ‚¬μ©ν•΄ λ‹¤λ€λ‹¤ κ΄€κ³„λ¥Ό μΌλ€λ‹¤, λ‹¤λ€μΌ κ΄€κ³„λ΅ ν’€μ–΄λ‚Ό μ μλ‹¤.
<p align="center"><img src="https://velog.velcdn.com/post-images%2Fconatuseus%2F7d8ce2d0-0b91-11ea-a6a4-f18ec5ff5eba%2Fimage.png" width="60%"></p>   

κ°μ²΄λ” ν…μ΄λΈ”κ³Ό λ‹¤λ¥΄κ² κ°μ²΄ 2κ°λ΅ λ‹¤λ€λ‹¤ κ΄€κ³„λ¥Ό λ§λ“¤ μ μλ‹¤.   

- νμ› κ°μ²΄λ” μ»¬λ ‰μ…μ„ μ‚¬μ©ν•΄ μƒν’λ“¤μ„ μ°Έμ΅°   
- λ°λ€λ΅ μƒν’λ“¤λ„ μ»¬λ ‰μ…μ„ μ‚¬μ©ν•΄ νμ›λ“¤μ„ μ°Έμ΅°ν•λ©΄ λλ‹¤.   

`@ManyToMany`λ¥Ό μ‚¬μ©ν•λ©΄ λ‹¤λ€λ‹¤ κ΄€κ³„λ¥Ό νΈλ¦¬ν•κ² λ§¤ν•‘ν•  μ μ‡λ‹¤.
<p align="center"><img src="https://velog.velcdn.com/post-images%2Fconatuseus%2Fe5e97ff0-0b91-11ea-be29-f571dc8d24b5%2Fimage.png" width="60%"></p>   

## 1. λ‹¤λ€λ‹¤ : λ‹¨λ°©ν–¥   
```java
//νμ›
@Entity
public class Member{
    @Id
    @GeneratedValue
    @Column(name = "MEMBER_ID")
    private String id;
    
    private String username;

    @ManyToMany
    @JoinTable(name = "MEMBER_PRODUCT", 
               joinColumn = @JoinColum(name = "MEMBER_ID"),
               inverseJoinColumns = @JoinColumn(name = "PRODUCT_ID"))
    private List<Product> products = new ArrayList<Product>();
}
```
```java
//μƒν’
@Entity
public class Product{
    @Id
    @GeneratedValue
    @Column(name = "PRODUCT_ID")
    private String id;

    private String name;
}
```   
νμ› μ—”ν‹°ν‹°μ™€ μƒν’ μ—”ν‹°ν‹°λ¥Ό `@ManyToMany`λ΅ λ§¤ν•‘ν–λ‹¤.   
μ¤‘μ”ν• μ μ€ **`@ManyToMany`μ™€ `@JoinTable`μ„ μ‚¬μ©ν•΄ μ—°κ²° ν…μ΄λΈ”μ„ λ°”λ΅ λ§¤ν•‘**ν• κ²ƒμ΄λ‹¤.   
λ”°λΌμ„ νμ›κ³Ό μƒν’μ„ μ—°κ²°ν•λ” νμ›_μƒν’(`Member_Product`) μ—”ν‹°ν‹° μ—†μ΄ λ§¤ν•‘μ„ μ™„λ£ν•  μ μλ‹¤.   

μ—°κ²° ν…μ΄λΈ”μ„ λ§¤ν•‘ν•λ” `@JoinTable`μ μ†μ„± μ •λ¦¬   
- `@JoinTable.name` : μ—°κ²° ν…μ΄λΈ”μ„ μ§€μ •ν•λ‹¤. (MEMBER_PRODUCT)   
- `@JoinTable.joinColumn` : ν„μ¬ λ°©ν–¥μΈ νμ›κ³Ό λ§¤ν•‘ν•  μ΅°μΈ μ»¬λΌ μ •λ³΄λ¥Ό μ§€μ •ν•λ‹¤. (MEMBER_ID)   
- `@JoinTable.inverseJoinColumns` : λ°λ€ λ°©ν–¥μΈ μƒν’κ³Ό λ§¤ν•‘ν•  μ΅°μΈ μ»¬λΌ μ •λ³΄λ¥Ό μ§€μ •ν•λ‹¤. (PRODUCT_ID)   

`MEMBER_PRODUCT`ν…μ΄λΈ”μ€ λ‹¤λ€λ‹¤ κ΄€κ³„λ¥Ό μΌλ€λ‹¤, λ‹¤λ€μΌ κ΄€κ³„λ΅ ν’€μ–΄λ‚΄κΈ° μ„ν•΄ ν•„μ”ν• μ—°κ²° ν…μ΄λΈ”μΌ λΏμ΄λ‹¤.   
`@ManyToMany`λ΅ λ§¤ν•‘ν• λ•λ¶„μ— λ‹¤λ€λ‹¤ κ΄€κ³„λ¥Ό μ‚¬μ©ν•  λ•λ” μ΄ μ—°κ²° ν…μ΄λΈ”μ„ μ‹ κ²½μ“°μ§€ μ•μ•„λ„ λλ‹¤.   

```java
//λ‹¤λ€λ‹¤ κ΄€κ³„λ¥Ό μ €μ¥ν•λ” μ
public void save(){
    Product productA = new Product();
    productA.setId("productA");
    productA.setName("μƒν’A");
    em.persist(productA);

    Member member1 = new Member();
    member1.setId("member1");
    member1.setUsername("νμ›1");
    member1.getProducts().add(productA); //μ—°κ΄€κ΄€κ³„ μ„¤μ •
    em.persist(member1);
}
```
νμ›1κ³Ό μƒν’Aμ μ—°κ΄€κ΄€κ³„λ¥Ό μ„¤μ •ν–μΌλ―€λ΅ νμ›μ„ μ €μ¥ν•  λ• μ—°κ²° ν…μ΄λΈ”μ—λ„ κ°’μ΄ μ €μ¥λλ‹¤.   
```sql
--μ‹¤ν–‰λλ” sql
INSERT INTO PRODUCT ...
INSERT INTO MEMBER ...
INSERT INTO MEMBER_PRODUCT ...
```

```java
//νƒμƒ‰
public void find(){
    Member member = em.find(Member.class, "member1");
    List<Product> products = member.getProducts(); // κ°μ²΄ κ·Έλν”„ νƒμƒ‰
}
```
```sql
--μ‹¤ν–‰λλ” sql
SELECT * FROM MEMBER_PRODUCT MP INNER JOIN PRODUCT P
ON MP.PRODUCT_ID = P.PRODUCT_ID
WHERE MP.MEMBER_ID=?
```
μ—°κ²° ν…μ΄λΈ”μΈ `MEMBER_PRODUCT`μ™€ μƒν’ ν…μ΄λΈ”μ„ μ΅°μΈν•΄ μ—°κ΄€λ μƒν’μ„ μ΅°νν•λ‹¤.   

`@ManyToMany` λ•λ¶„μ— λ³µμ΅ν• λ‹¤λ€λ‹¤ κ΄€κ³„λ¥Ό μ• ν”λ¦¬μΌ€μ΄μ…μ—μ„ λ‹¨μν•κ² μ‚¬μ©ν•  μ μλ‹¤.   

## 2. λ‹¤λ€λ‹¤ : μ–‘λ°©ν–¥   
```java
@Entity
public class Product{
    @Id
    private String id;

    @ManyToMany(mappedBy = "products") //μ—­λ°©ν–¥ μ¶”κ°€
    private List<Member> members;
}
```
```java
//λ‹¤λ€λ‹¤μ μ–‘λ°©ν–¥ μ—°κ΄€κ΄€κ³„μ μ„¤μ •
member.getProducts().add(product);
product.getMembers().add(member);
```

μ–‘λ°©ν–¥ μ—°κ΄€κ΄€κ³„λ” μ—°κ΄€κ΄€κ³„ νΈμ λ©”μ†λ“λ¥Ό μ¶”κ°€ν•΄μ„ κ΄€λ¦¬ν•λ” κ²ƒμ΄ νΈλ¦¬ν•λ‹¤.   
```java
//νμ› μ—”ν‹°ν‹° μ—°κ΄€κ΄€κ³„ νΈμ λ©”μ†λ“ μ¶”κ°€
public void addProduct(Product product){
    ...
    products.add(product);
    product.getMembers().add(this);
}

//μ‚¬μ©
member.addProduct(product);
```
μ–‘λ°©ν–¥ μ—°κ΄€κ΄€κ³„λ΅ λ§λ“¤μ—μΌλ―€λ΅ `product.getMembers()`λ¥Ό μ΄μ©ν•΄ μ—­λ°©ν–¥μΌλ΅ κ°μ²΄ κ·Έλν”„λ¥Ό νƒμƒ‰ν•  μ μλ‹¤.   
```java
//μ—­λ°©ν–¥ νƒμƒ‰
public void findInverse(){
    Product product = em.find(Product.class, "productA");
    List<Member> members = product.getMembers();
}
```

## 3. λ‹¤λ€λ‹¤ : λ§¤ν•‘μ ν•κ³„μ™€ κ·Ήλ³µ, μ—°κ²° μ—”ν‹°ν‹° μ‚¬μ©   
`@ManyToMany`λ¥Ό μ‚¬μ©ν•λ©΄ μ—°κ²° ν…μ΄λΈ”μ„ μλ™μΌλ΅ μ²λ¦¬ν•΄μ£Όλ―€λ΅ λ„λ©”μΈ λ¨λΈμ΄ λ‹¨μν•΄μ§€κ³  μ—¬λ¬ κ°€μ§€λ΅ νΈλ¦¬ν•λ‹¤.   
*ν•μ§€λ§ μ΄ λ§¤ν•‘μ„ μ‹¤λ¬΄μ—μ„ μ‚¬μ©ν•κΈ°μ—λ” ν•κ³„κ°€ μλ‹¤.*   

μ) νμ›μ΄ μƒν’μ„ μ£Όλ¬Έν•λ©΄ μ—°κ²° ν…μ΄λΈ”μ— λ‹¨μν μ£Όλ¬Έν• νμ› μ•„μ΄λ””μ™€ μƒν’ μ•„μ΄λ””λ§ λ‹΄κ³  λλ‚μ§€ μ•λ”λ‹¤.   
λ³΄ν†µμ€ μ—°κ²° ν…μ΄λΈ”μ— μ£Όλ¬Έ μλ‰ μ»¬λΌμ΄λ‚ μ£Όλ¬Έν• λ‚ μ§ κ°™μ€ μ»¬λΌμ΄ λ” ν•„μ”ν•λ‹¤.   

<p align="center"><img src="https://velog.velcdn.com/post-images%2Fconatuseus%2Fedd261e0-0b92-11ea-be29-f571dc8d24b5%2Fimage.png" width="60%"></p>   

μ—°κ²° ν…μ΄λΈ”μ— μ£Όλ¬Έ μλ‰(ORDERAMOUNT)κ³Ό μ£Όλ¬Έ λ‚ μ§(ORDERDATE) μ»¬λΌμ„ μ¶”κ°€ν–λ‹¤.   
μ΄λ ‡κ² μ»¬λΌμ„ μ¶”κ°€ν•λ©΄ λ”λ” `@ManyToMany`λ¥Ό μ‚¬μ©ν•  μ μ—†λ‹¤.   
μ£Όλ¬Έ μ—”ν‹°ν‹°λ‚ μƒν’ μ—”ν‹°ν‹°μ—λ” μ¶”κ°€ν• μ»¬λΌλ“¤μ„ λ§¤ν•‘ν•  μ μ—†κΈ° λ•λ¬Έμ΄λ‹¤.   

<p align="center"><img src="https://blog.kakaocdn.net/dn/HdvJk/btrcgPui4uW/7JMdVVu7ksOhb9FuFEpvnk/img.png" width="60%"></p>   

κ²°κµ­ λ‹¤μμ²λΌ μ—°κ²° ν…μ΄λΈ”μ„ λ§¤ν•‘ν•λ” **μ—°κ²° μ—”ν‹°ν‹°(`MemberProduct`)λ¥Ό λ§λ“¤κ³ ** μ΄κ³³μ— **μ¶”κ°€ν• μ»¬λΌλ“¤μ„ λ§¤ν•‘**ν•΄μ•Ό ν•λ‹¤.   
κ·Έλ¦¬κ³  μ—”ν‹°ν‹° κ°„μ κ΄€κ³„λ„ ν…μ΄λΈ” κ΄€κ³„μ²λΌ **λ‹¤λ€λ‹¤μ—μ„ μΌλ€λ‹¤, λ‹¤λ€μΌ κ΄€κ³„λ΅ ν’€μ–΄μ•Ό ν•λ‹¤.**
```java
//νμ›
@Entity
public class Member{
    @Id
    @Column(name = "MEMBER_ID")
    private String id;
    
    //μ—­λ°©ν–¥
    @OneToMany(mappedBy = "member")
    private List<MemberProduct> memberProducts;
}
```
νμ›κ³Ό νμ›μƒν’μ„ μ–‘λ°©ν–¥ κ΄€κ³„λ΅ λ§λ“¤μ—λ‹¤.   
νμ›μƒν’ μ—”ν‹°ν‹° μ½μ΄ μ™Έλν‚¤λ¥Ό κ°€μ§€κ³  μμΌλ―€λ΅ μ—°κ΄€κ΄€κ³„μ μ£ΌμΈμ΄λ‹¤.   
λ”°λΌμ„ μ—°κ΄€κ΄€κ³„μ μ£ΌμΈμ΄ μ•„λ‹ νμ›μ `Member.memberProducts`μ— `mappedBy`λ¥Ό μ‚¬μ©ν–λ‹¤.   

```java
//μƒν’
@Entity
public class Product{
    @Id
    @Column(name = "PRODUCT_ID")
    private String id;

    private String name;
}
```
μƒν’ μ—”ν‹°ν‹°μ—μ„ νμ›μƒν’ μ—”ν‹°ν‹°λ΅ κ°μ²΄ κ·Έλν”„ νƒμƒ‰ κΈ°λ¥μ΄ ν•„μ”ν•μ§€ μ•λ‹¤κ³  νλ‹¨ν•μ—¬ μ—°κ΄€κ΄€κ³„λ¥Ό λ§λ“¤μ§€ μ•μ•λ‹¤.   

```java
//νμ›μƒν’ μ—”ν‹°ν‹°
@Entity
@IdClass(MemberProductId.class)
public class MemberProduct{
    @Id
    @ManyToOne
    @JoinColumn(name = "MEMBER_ID")
    private Member member;   //MemberProductId.memberμ™€ μ—°κ²°

    @Id
    @ManyToOne
    @JoinColumn(name = "PRODUCT_ID")
    private Product product; //MemberProductId.productμ™€ μ—°κ²°

    private int orderAmount;
}
```
```java
//νμ›μƒν’ μ‹λ³„μ
public class MemberProductId implements Serializable{
    private String member;  //MemberProduct.memberμ™€ μ—°κ²°
    private String product; //MemberProduct.productμ™€ μ—°κ²°

    @Override
    public boolean equals(Object o){...}
    
    @Override
    public int equals(Object o){...}
}
```
κΈ°λ³Έν‚¤λ¥Ό λ§¤ν•‘ν•λ” `@Id`μ™€ μ™Έλν‚¤λ¥Ό λ§¤ν•‘ν•λ” `@JoinColumn`μ„ λ™μ‹μ— μ‚¬μ©ν•΄   
κΈ°λ³Έν‚¤ + μ™Έλν‚¤λ¥Ό ν•λ²μ— λ§¤ν•‘ν–κ³  `@IdClass`λ¥Ό μ‚¬μ©ν•΄ λ³µν•©ν‚¤λ¥Ό λ§¤ν•‘ν–λ‹¤.   

- λ³µν•© κΈ°λ³Έ ν‚¤(λ³µν•©ν‚¤)   
νμ›μƒν’ μ—”ν‹°ν‹°λ” κΈ°λ³Έν‚¤κ°€ `MEMBER_ID`μ™€ `PRODUCT_ID`λ΅ μ΄λ£¨μ–΄μ§„ λ³µν•©ν‚¤λ‹¤.   
JPAμ—μ„ λ³µν•©ν‚¤λ¥Ό μ‚¬μ©ν•λ ¤λ©΄ λ³„λ„μ μ‹λ³„μ ν΄λμ¤(`MemberProductId`)λ¥Ό λ§λ“¤μ–΄μ•Ό ν•λ‹¤.   
κ·Έλ¦¬κ³  μ—”ν‹°ν‹°μ— `@IdClass`λ¥Ό μ‚¬μ©ν•΄μ„ μ‹λ³„μ ν΄λμ¤λ¥Ό μ§€μ •ν•λ©΄ λλ‹¤.   

    μ‹λ³„μ ν΄λμ¤μ νΉμ§•   
    - λ³µν•©ν‚¤λ” λ³„λ„μ μ‹λ³„μ ν΄λμ¤λ΅ λ§λ“¤μ–΄μ•Ό ν•λ‹¤.
    - `Serializable`μ„ κµ¬ν„ν•΄μ•Ό ν•λ‹¤.
    - `equals`μ™€ `hashCode` λ©”μ†λ“λ¥Ό κµ¬ν„ν•΄μ•Ό ν•λ‹¤.
    - κΈ°λ³Έ μƒμ„±μκ°€ μμ–΄μ•Ό ν•λ‹¤.
    - μ‹λ³„μ ν΄λμ¤λ” `public`μ΄μ–΄μ•Ό ν•λ‹¤.
    - `@IdClass`λ¥Ό μ‚¬μ©ν•λ” λ°©λ²• μ™Έμ— `@EmbeddedId`λ¥Ό μ‚¬μ©ν•λ” λ°©λ²•λ„ μλ‹¤.   

- μ‹λ³„ κ΄€κ³„   
<u>νμ›μƒν’μ€ νμ›κ³Ό μƒν’μ κΈ°λ³Έν‚¤λ¥Ό λ°›μ•„μ„ μμ‹ μ κΈ°λ³Έν‚¤λ΅ μ‚¬μ©ν•λ‹¤.</u>   

*λ¶€λ¨ ν…μ΄λΈ”μ κΈ°λ³Έν‚¤λ¥Ό λ°›μ•„μ„ **μμ‹ μ κΈ°λ³Έν‚¤ + μ™Έλν‚¤λ΅ μ‚¬μ©**ν•λ” κ²ƒμ„ λ°μ΄ν„°λ² μ΄μ¤ μ©μ–΄λ΅ **μ‹λ³„ κ΄€κ³„(Identifying Relationship)** λΌ ν•λ‹¤.*   

μΆ…ν•©ν•΄λ³΄λ©΄ νμ›μƒν’(`MemberProduct`)μ€ νμ›μ κΈ°λ³Έν‚¤λ¥Ό λ°›μ•„μ„ μμ‹ μ κΈ°λ³Έν‚¤λ΅ μ‚¬μ©ν•¨κ³Ό λ™μ‹μ— νμ›κ³Όμ κ΄€κ³„λ¥Ό μ„ν• μ™Έλν‚¤λ΅ μ‚¬μ©ν•λ‹¤.   
κ·Έλ¦¬κ³  μƒν’μ κΈ°λ³Έν‚¤λ„ λ°›μ•„μ„ μμ‹ μ κΈ°λ³Έν‚¤λ΅ μ‚¬μ©ν•¨κ³Ό λ™μ‹μ— μƒν’κ³Όμ κ΄€κ³„λ¥Ό μ„ν• μ™Έλν‚¤λ΅ μ‚¬μ©ν•λ‹¤.   
λ **`MemberProductId` μ‹λ³„μ ν΄λμ¤λ΅ λ‘ κΈ°λ³Έν‚¤λ¥Ό λ¬¶μ–΄ λ³µν•©ν‚¤λ΅ μ‚¬μ©**ν•λ‹¤.   

```java
//μ €μ¥ μ½”λ“
public void save(){
    Member member1 = new Member();
    member1.setId("member1");
    member1.setUsername("νμ›1");
    em.persist(member1);

    Product productA = new Product();
    productA.setId("productA");
    productA.setName("μƒν’A");
    em.persist(productA);

    MemberProduct memberProduct = new MemberProduct();
    memberProduct.setMember(member1);   //μ£Όλ¬Έ νμ› - μ—°κ΄€κ΄€κ³„ μ„¤μ •
    memberProduct.setProduct(productA); //μ£Όλ¬Έ μƒν’ - μ—°κ΄€κ΄€κ³„ μ„¤μ •
    memberProduct.setOrderAmount(2);    //μ£Όλ¬Έ μλ‰

    em.persist(memberProduct);
}
```
νμ›μƒν’ μ—”ν‹°ν‹°λ¥Ό λ§λ“¤λ©΄μ„ μ—°κ΄€λ νμ› μ—”ν‹°ν‹°μ™€ μƒν’ μ—”ν‹°ν‹°λ¥Ό μ„¤μ •ν–λ‹¤.   
νμ›μƒν’ μ—”ν‹°ν‹°λ” DBμ— μ €μ¥λ  λ• μ—°κ΄€λ νμ›μ μ‹λ³„μμ™€ μƒν’μ μ‹λ³„μλ¥Ό κ°€μ Έμ™€μ„ μμ‹ μ κΈ°λ³Έν‚¤ κ°’μΌλ΅ μ‚¬μ©ν•λ‹¤.

```java
//μ΅°ν μ½”λ“
public void find(){
    //κΈ°λ³Έν‚¤ κ°’ μƒμ„±
    MemberProductId memberProductId = new MemberProductId();
    memberProductId.setMember("member1");
    memberProductId.setProduct("productA");

    MemberProduct memberProduct = em.find(MemberProduct.class, MemberProductId);

    Member member = memberProduct.getMember();
    Product product = memberProduct.getProduct();
}
```
**λ³µν•©ν‚¤λ” ν•­μƒ μ‹λ³„μ ν΄λμ¤λ¥Ό λ§λ“¤μ–΄μ•Ό ν•λ‹¤.**   
`em.find()`λ¥Ό λ³΄λ©΄ μƒμ„±ν• μ‹λ³„μ ν΄λμ¤λ΅ μ—”ν‹°ν‹°λ¥Ό μ΅°νν•λ‹¤.   

λ³µν•©ν‚¤λ¥Ό μ‚¬μ©ν•λ” λ°©λ²•μ€ λ³µμ΅ν•λ‹¤.   
λ‹¨μν μ»¬λΌ ν•λ‚λ§ κΈ°λ³Έν‚¤λ΅ μ‚¬μ©ν•λ” κ²ƒκ³Ό λΉ„κµν•΄μ„ λ³µν•©ν‚¤λ¥Ό μ‚¬μ©ν•λ©΄ ORM λ§¤ν•‘μ—μ„ μ²λ¦¬ν•  μΌμ΄ μƒλ‹Ήν λ§μ•„μ§„λ‹¤.   
λ³µν•©ν‚¤λ¥Ό μ„ν• μ‹λ³„μ ν΄λμ¤λ„ λ§λ“¤μ–΄μ•Ό ν•κ³  `@IdClass` λλ” `@EmbeddedId`λ„ μ‚¬μ©ν•΄μ•Ό ν•λ‹¤.
κ·Έλ¦¬κ³  μ‹λ³„μ ν΄λμ¤μ— `equals`, `hasCode` λ©”μ†λ“λ„ κµ¬ν„ν•΄μ•Ό ν•λ‹¤.   

## 4. λ‹¤λ€λ‹¤ : μƒλ΅μ΄ κΈ°λ³Έν‚¤ μ‚¬μ©   
- μ¶”μ²ν•λ” κΈ°λ³Έν‚¤ μƒμ„± μ „λµμ€ DBμ—μ„ μλ™μΌλ΅ μƒμ„±ν•΄μ£Όλ” λ€λ¦¬ ν‚¤λ¥Ό LongμΌλ΅ μ‚¬μ©ν•λ” λ°©λ²•
- κ°„νΈν•κ³  μκµ¬ν μ‚¬μ©κ°€λ¥, λΉ„μ¦λ‹μ¤μ— μμ΅΄μ μ΄μ§€ μ•λ” μ¥μ 
- **λ³µν•©ν‚¤(MEMBER_ID, PRODUCT_ID) λ€μ‹  ORDER_IDμΈ λ€λ¦¬ν‚¤λ¥Ό μ‚¬μ©**

νμ›μƒν’(MemberProduct) -> μ£Όλ¬Έ(Order)μ΄λ¦„μ΄ μ–΄μΈλ¦Ό(μμ•½μ–΄ μ΅°μ‹¬)
<p align="center"><img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FlyCla%2FbtrctvOvfRf%2FswU5kQtAQ9KvWoExAw2j0K%2Fimg.png" width="60%"></p>  

`ORDER_ID`λΌλ” μƒλ΅μ΄ κΈ°λ³Έν‚¤λ¥Ό ν•λ‚ λ§λ“¤κ³  `MEBER_ID`, `PRODUCT_ID` μ»¬λΌμ€ μ™Έλν‚¤λ΅λ§ μ‚¬μ©ν•λ‹¤.   

```java
//μ£Όλ¬Έ μ½”λ“
@Entity
public class Order{
    @Id @GeneratedValue
    @Column(name = "ORDER_ID")
    private Long id;

    @ManyToOne
    @JoinColumn(name = "MEMBER_ID")
    private Member member;

    @ManyToOne
    @JoinColumn(name = "PRODUCT_ID")
    private Product product;

    private int orderAmount;
}
```
λ€λ¦¬ν‚¤λ¥Ό μ‚¬μ©ν•¨μΌλ΅μ¨ μ‹λ³„ κ΄€κ³„μ— λ³µν•©ν‚¤λ¥Ό μ‚¬μ©ν•λ” κ²ƒλ³΄λ‹¤ λ§¤ν•‘μ΄ λ‹¨μν•κ³  μ΄ν•΄ν•κΈ° μ‰½λ‹¤.   

νμ› μ—”ν‹°ν‹°μ™€ μƒν’ μ—”ν‹°ν‹°λ” λ³€κ²½μ‚¬ν•­X   

```java
//μ €μ¥ μ½”λ“
public void save(){
    Member member1 = new Member();
    member1.setId("member1");
    member1.setUsername("νμ›1");
    em.persist(member1);

    Product productA = new Product();
    productA.setId("productA");
    productA.setName("μƒν’A");
    em.persist(productA);

    Order order = new Order();
    order.setMember(member1);    //μ£Όλ¬Έ νμ› - μ—°κ΄€κ΄€κ³„ μ„¤μ •
    order.setProduct(productA);  //μ£Όλ¬Έ μƒν’ - μ—°κ΄€κ΄€κ³„ μ„¤μ •
    order.setOrderAmount(2);     //μ£Όλ¬Έ μλ‰
    em.persist(order);
}
```
```java
//μ΅°ν
public void find(){
    Long orderId = 1L;
    Order order = em.find(Order.class, orderId);

    Member member = order.getMember();
    Product product = order.getProduct();
}
```
μ‹λ³„μ ν΄λμ¤λ¥Ό μ‚¬μ©ν•μ§€ μ•μ•„ μ½”λ“κ°€ λ‹¨μν•΄μ΅λ‹¤.   
*μƒλ΅μ΄ κΈ°λ³Έν‚¤λ¥Ό μ‚¬μ©ν•΄μ„ λ‹¤λ€λ‹¤ κ΄€κ³„λ¥Ό ν’€μ–΄λ‚΄λ” κ²ƒλ„ μΆ‹μ€ λ°©λ²•μ΄λ‹¤.*   

## 5. λ‹¤λ€λ‹¤ μ—°κ΄€κ΄€κ³„ μ •λ¦¬   
λ‹¤λ€λ‹¤ κ΄€κ³„λ¥Ό μΌλ€λ‹¤, λ‹¤λ€μΌ κ΄€κ³„λ΅ ν’€μ–΄λ‚΄κΈ° μ„ν•΄   
μ—°κ²° ν…μ΄λΈ”μ„ λ§λ“¤ λ• μ‹λ³„μλ¥Ό μ–΄λ–»κ² κµ¬μ„±ν• μ§€ μ„ νƒν•΄μ•Ό ν•λ‹¤.
- μ‹λ³„ κ΄€κ³„ : λ°›μ•„μ¨ μ‹λ³„μλ¥Ό κΈ°λ³Έν‚¤ + μ™Έλν‚¤λ΅ μ‚¬μ©ν•λ‹¤.
- λΉ„μ‹λ³„ κ΄€κ³„ : λ°›μ•„μ¨ μ‹λ³„μλ” μ™Έλν‚¤λ΅λ§ μ‚¬μ©ν•κ³  **μƒλ΅μ΄ μ‹λ³„μλ¥Ό μ¶”κ°€**ν•λ‹¤.

**μ‹λ³„ κ΄€κ³„λ³΄λ‹¤λ” λΉ„μ‹λ³„ κ΄€κ³„λ¥Ό μ¶”μ²(7.3)**
