# 📝 정리   
연관관계의 주인도 정해야하고, 로직도 잘 관리해야 한다.   
중요한 점은 연관관계가 하나인 단방향 매핑은 언제나 연관관계의 주인이다.   
양방향은 주인이 아닌 연관관계를 하나 추가했을 뿐.   

<u>결국 양방향의 장점은 반대방향으로 **객체 그래프 탐색 기능이 추가**된 것뿐이다.</u>
```java
member.getTeam();  //회원->팀
team.getMembers(); //팀->회원 (양방향 매핑으로 추가된 기능)
```

주인의 반대편은 `mappedBy`로 주인을 지정해야 하고, 단순히 보여주는 일(객체 그래프 탐색)만 할 수 있다.

**내용 정리**
- 단방향 매핑만으로 테이블과 객체의 연관관계 매핑은 이미 완료됨
- 단방향을 양방향으로 만들면 반대방향으로 객체 그래프 탐색 기능이 추가됨
- 양방향 연관관계를 매핑하려면 객체에서 양쪽 방향을 모두 관리해야 함   

비즈니스 로직의 필요에 따라 다르겠지만우선 단방향 매핑을 사용하고 반대 방향으로 객체 그래프 탐색 기능(JPQL 쿼리 탐색 포함)이 필요할 때 양방향을 사용하도록 코드를 추가해도 된다.

⭐ 연관관계의 주인을 정하는 기준
- 단방향은 항상 외래키가 있는 곳을 기준으로 매핑
- 양방향은 비즈니스 로직상 더 중요하다고 주인으로 선택하면 안됨   
비즈니스 중요도를 배제하고 단순히 외래키 관리자 정도의 의미만 부여
- ***연관관계의 주인은 외래키의 위치와 관련해서 정해야지 비즈니스로 접근하면 안됨***   

<details>
<summary>주의</summary>

양방향 매핑 시 무한 루프에 빠지지 않게 조심해야 한다.   
예) `Member.toString()`에서 `getTeam()`을 호출하고, `Team.toString()`에서 `getMember()`를 호출하면 무한 루프에 빠질 수 있다.   

엔티티를 JSON으로 변환할때 자주 발생(무한루프에 빠지지 않도록 하는 어노테이션 제공)   
Lombok 라이브러리 사용할 때도 자주 발생
</details>

<details>
<summary>참고</summary>

일대다를 연관관계의 주인으로 선택하는 것이 가능하긴 하다.   
예) `Team.members`를 연관관계의 주인으로 선택하는 것   

성능 관리 측면에서 권장하지 않는다.(6장 2-1 참고)   
*될 수 있으면 외래키가 있는 곳을 연관관계의 주인으로 선택*
</details>